- type: entity
  parent: MCWeaponSmartGun
  id: MCWeaponSmartGunSG62
  name: SG-62 Kauser-KT smart target rifle
  description: The Kauser-KT SG-62 is a IFF-capable rifle used by the TerraGov Marine Corps, coupled with a spotting rifle that is also IFF capable of applying various bullets with specialized ordnance, this is a gun with many answers to many situations... if you have the right ammo loaded. Requires special training and it cannot turn off IFF. It uses high velocity 10x27mm for the rifle and 12x66mm ammunition for the underslung rifle.
  components:
  - type: Item
    size: Huge
  - type: AmmoCounter
  - type: MagazineAmmoProvider
    autoEject: true
  - type: RMCAmmoEject
  - type: MagazineVisuals
    magState: mag
    steps: 1
    zeroVisible: true
  - type: Appearance
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Smartguns/sg62.rsi
    layers:
    - state: base
      sprite: _MC/Objects/Weapons/Guns/Smartguns/sg62.rsi
    - state: mag-0
      sprite: _MC/Objects/Weapons/Guns/Smartguns/sg62.rsi
      map: [ "enum.GunVisualLayers.Mag" ]
  - type: Clothing
    sprite: _MC/Objects/Weapons/Guns/Smartguns/sg62.rsi
    slots:
    - suitStorage
    - Back
  - type: MeleeWeapon
    damage:
      groups:
        Brute: 20
  - type: ItemSlots
    slots:
      gun_magazine:
        name: Magazine
        startingItem: MCMagazineSmartGunSG62
        insertSound: /Audio/_MC/Weapons/Guns/Reload/t42_reload.ogg
        ejectSound: /Audio/_MC/Weapons/Guns/Reload/t42_unload.ogg
        priority: 2
        whitelist:
          tags:
          - MCMagazineSmartGunSG62
  # Stats
  - type: Gun
    selectedMode: FullAuto
    availableModes:
    - FullAuto
    soundGunshot:
      path: /Audio/_MC/Weapons/Guns/Fire/t62.ogg
    soundEmpty:
      path: /Audio/_MC/Weapons/Guns/Fire/m41a_empty.ogg
  - type: GunIFF
    enabled: true
  - type: RMCSelectiveFire
    baseFireModes:
    - FullAuto
    baseFireRate: 2 # fire delay 0.5
    scatterWielded: 0
    scatterUnwielded: 20
    recoilWielded: 0
    recoilUnwielded: 0
    modifiers:
      FullAuto:
        shotsToMaxScatter: null
  - type: RMCWeaponAccuracy
    accuracyMultiplier: 1.1
    accuracyMultiplierUnwielded: 0.4
  # Wield
  - type: GunRequiresWield
  - type: Wieldable
  - type: WieldDelay
    baseDelay: 0.85
  # Skills
  - type: MCGunSkilled
    skill: RMCSkillSmartGun
  # Crosshair
  - type: WieldedCrosshair
    rsi:
      sprite: _RMC14/Interface/MousePointer/smartgun_mouse.rsi
      state: all
  # Attachments
  - type: AttachableHolder
    slots:
      mc-slot-rail:
        whitelist:
          tags:
          - MCAttachmentMagneticHarness
          - MCAttachmentRailFlashlight
          - MCAttachmentMiniScope
          - MCAttachmentT47RailScope
      mc-slot-stock:
        locked: true
        startingAttachable: MCAttachmentStockSG62
        whitelist:
          tags:
          - MCAttachmentStockSG62
      mc-slot-underbarrel:
        locked: true
        startingAttachable: MCAttachmentUnderbarrelSG62
        whitelist:
          tags:
          - MCAttachmentUnderbarrelSG62
  - type: AttachableHolderVisuals
    offsets:
      mc-slot-stock: -0.78125, 0.0625
      mc-slot-underbarrel: 0.1875, 0

# Attachments
- type: entity
  parent: MCAttachmentBaseStock
  id: MCAttachmentStockSG62
  categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    state: sg62_a
  - type: Tag
    tags:
    - MCAttachmentStock
    - MCAttachmentStockSG62
  - type: AttachableVisuals
    suffix: ""

- type: Tag
  id: MCAttachmentStockSG62

- type: entity
  parent: [ MCAttachmentBaseUnderbarrel, RMCAttachableToggleableBase ]
  id: MCAttachmentUnderbarrelSG62
  name: SG-153 spotting rifle
  description: An underslung spotting rifle, generally found ontop of another gun.
  components:
  - type: Tag
    tags:
    - MCAttachmentUnderbarrel
    - MCAttachmentUnderbarrelSG62
  - type: Sprite
    layers:
    - state: sg153_e_a
    # - state: sg153_a
    #   map: [ "enum.GunVisualLayers.Mag" ]
  - type: Item
    size: Normal
  # Gun
  - type: Gun
    soundGunshot:
      path: /Audio/_MC/Weapons/Guns/Fire/spottingrifle.ogg
  - type: GunIFF
    enabled: true
  - type: RMCSelectiveFire
    baseFireRate: 1 # fire delay 1
    scatterWielded: 0
    scatterUnwielded: 0
    recoilWielded: 0
    recoilUnwielded: 0
  - type: GunPointBlank
  - type: RMCWeaponAccuracy
    accuracyMultiplier: 1.25
    accuracyMultiplierUnwielded: 1.25
  # Ammo provider
  - type: AmmoCounter
  - type: RMCAmmoEject
  - type: MagazineAmmoProvider
    autoEject: true
  # - type: MagazineVisuals
  #   magState: mag
  #   steps: 1
  #   zeroVisible: true
  - type: ContainerContainer
    containers:
      gun_magazine: !type:ContainerSlot ""
      gun_chamber: !type:ContainerSlot ""
  - type: ItemSlots
    slots:
      gun_magazine:
        name: Magazine
        startingItem: MCMagazineSmartGunSG153
        insertSound: /Audio/_MC/Weapons/Guns/Reload/t42_reload.ogg
        ejectSound: /Audio/_MC/Weapons/Guns/Reload/t42_unload.ogg
        priority: 2
        whitelist:
          tags:
          - MCMagazineSmartGunSG153
  # Skills
  - type: MCGunSkilled
    skill: RMCSkillSmartGun
  # Crosshair
  - type: WieldedCrosshair
    rsi:
      sprite: _RMC14/Interface/MousePointer/smartgun_mouse.rsi
      state: all
  # Attachable
  - type: AttachableVisuals
    suffix: ""
  - type: AttachableToggleable
    userOnly: true
    attachedOnly: true
    supercedeHolder: true
    wieldedUseOnly: true
    activatePopupText: attachable-popup-switch-to-generic
    deactivatePopupText: attachable-popup-switch-from-generic
    activateSound:
      path: /Audio/_RMC14/Attachable/gun_u7_activate.ogg
      params:
        volume: -2
    actionName: SG-153 spotting rifle
    actionDesc: An underslung spotting rifle, generally found ontop of another gun.
    icon:
      sprite: _MC/Objects/Weapons/Guns/Attachments/underbarrel.rsi
      state: sg153_a
    iconActive:
      sprite: _MC/Objects/Weapons/Guns/Attachments/underbarrel.rsi
      state: sg153_on

- type: Tag
  id: MCAttachmentUnderbarrelSG62

# Magazine SG-62
- type: entity
  parent: CMMagazineRifleBase
  id: MCMagazineSmartGunSG62
  name: SG-62 magazine (10x27mm HV)
  description: A magazine filled with 10x27mm specialized smart rounds.
  components:
  - type: Appearance
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Magazines/sg62.rsi
    layers:
    - state: base
      map: [ "enum.GunVisualLayers.Base" ]
    - state: mag-1
      map: [ "enum.GunVisualLayers.Mag" ]
  - type: Tag
    tags:
    - MCMagazineRifle
    - MCMagazineSmartGunSG62
  - type: BallisticAmmoProvider
    mayTransfer: True
    whitelist:
      tags:
      - MCCartridgeSmartGunSG62
    proto: MCCartridgeSmartGunSG62
    capacity: 40

- type: Tag
  id: MCMagazineSmartGunSG62

# Magazine SG-153
- type: entity
  parent: CMMagazineRifleBase
  id: MCMagazineSmartGunSG153
  name: SG-153 magazine (12.7mm Smart Magnum)
  description: A magazine filled with 12.7mm lethal smart rounds, these will do nothing other than pack a big punch.
  components:
  - type: Appearance
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Magazines/sg153.rsi
    layers:
    - state: base
      map: [ "enum.GunVisualLayers.Base" ]
    - state: mag-1
      map: [ "enum.GunVisualLayers.Mag" ]
  - type: Tag
    tags:
    - MCMagazineRifle
    - MCMagazineSmartGunSG153
  - type: BallisticAmmoProvider
    mayTransfer: True
    whitelist:
      tags:
      - MCCartridgeSmartGunSG153
    proto: MCCartridgeSmartGunSG153
    capacity: 5

- type: Tag
  id: MCMagazineSmartGunSG153

- type: entity
  parent: MCMagazineSmartGunSG153
  id: MCMagazineSmartGunSG153Highimpact
  name: SG-153 high impact magazine (12.7mm Smart Magnum)
  description: A magazine filled with 12.7mm high impact smart rounds, these will likely stagger and slow anything they hit.
  components:
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Magazines/sg153_hi.rsi
  - type: BallisticAmmoProvider
    whitelist:
      tags:
      - MCCartridgeSmartGunSG153Highimpact
    proto: MCCartridgeSmartGunSG153Highimpact

- type: entity
  parent: MCMagazineSmartGunSG153
  id: MCMagazineSmartGunSG153Heavyrubber
  name: SG-153 heavy rubber magazine (12.7mm Smart Magnum)
  description: A magazine filled with 12.7mm heavy rubber smart rounds, these will likely stun and displace anything they hit.
  components:
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Magazines/sg153_hr.rsi
  - type: BallisticAmmoProvider
    whitelist:
      tags:
      - MCCartridgeSmartGunSG153Heavyrubber
    proto: MCCartridgeSmartGunSG153Heavyrubber

- type: entity
  parent: MCMagazineSmartGunSG153
  id: MCMagazineSmartGunSG153Plasmaloss
  name: SG-153 tanglefoot magazine (12.7mm Smart Magnum)
  description: A magazine filled with 12.7mm smart rounds tipped with 'Tanglefoot' poison, these rounds will drain the energy out of targets they hit.
  components:
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Magazines/sg153_pl.rsi
  - type: BallisticAmmoProvider
    whitelist:
      tags:
      - MCCartridgeSmartGunSG153Plasmaloss
    proto: MCCartridgeSmartGunSG153Plasmaloss

- type: entity
  parent: MCMagazineSmartGunSG153
  id: MCMagazineSmartGunSG153Tungsten
  name: SG-153 tungsten magazine (12.7mm Smart Magnum)
  description: A magazine filled with 12.7mm tungsten smart rounds, these rounds will massively knock back any target it hits.
  components:
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Magazines/sg153_tg.rsi
  - type: BallisticAmmoProvider
    whitelist:
      tags:
      - MCCartridgeSmartGunSG153Tungsten
    proto: MCCartridgeSmartGunSG153Tungsten

- type: entity
  parent: MCMagazineSmartGunSG153
  id: MCMagazineSmartGunSG153Incendiary
  name: SG-153 incendiary magazine (12.7mm Smart Magnum)
  description: A magazine filled with 12.7mm incendiary smart rounds, these rounds will set alight anything they hit.
  components:
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Magazines/sg153_ic.rsi
  - type: BallisticAmmoProvider
    whitelist:
      tags:
      - MCCartridgeSmartGunSG153Incendiary
    proto: MCCartridgeSmartGunSG153Incendiary

- type: entity
  parent: MCMagazineSmartGunSG153
  id: MCMagazineSmartGunSG153Flak
  name: SG-153 flak magazine (12.7mm Smart Magnum)
  description: A magazine filled with 12.7mm flak smart rounds, these rounds will airburst on contact with an organic target, causing damage in a small area near the target.
  components:
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Magazines/sg153_fl.rsi
  - type: BallisticAmmoProvider
    whitelist:
      tags:
      - MCCartridgeSmartGunSG153Flak
    proto: MCCartridgeSmartGunSG153Flak

# Cartridges SG-62
- type: entity
  parent: CMBaseCartridgeRifle
  id: MCCartridgeSmartGunSG62
  name: smartmachinegun bullet (10x26mm caseless)
  description: A handful of rounds to reload on the go.
  components:
  - type: Tag
    tags:
    - MCCartridgeSmartGunSG62
  - type: CartridgeAmmo
    proto: MCBulletSmartGunSG62

- type: Tag
  id: MCCartridgeSmartGunSG62

# Cartridges SG-153
- type: entity
  parent: CMBaseCartridgeRifle
  id: MCCartridgeSmartGunSG153
  name: smartmachinegun bullet (10x26mm caseless)
  description: A handful of rounds to reload on the go.
  components:
  - type: Tag
    tags:
    - MCCartridgeSmartGunSG153
  - type: CartridgeAmmo
    proto: MCBulletSmartGunSG153

- type: Tag
  id: MCCartridgeSmartGunSG153

- type: entity
  parent: MCCartridgeSmartGunSG153
  id: MCCartridgeSmartGunSG153Highimpact
  components:
  - type: Tag
    tags:
    - MCCartridgeSmartGunSG153Highimpact
  - type: CartridgeAmmo
    proto: MCBulletSmartGunSG153Highimpact

- type: Tag
  id: MCCartridgeSmartGunSG153Highimpact

- type: entity
  parent: MCCartridgeSmartGunSG153
  id: MCCartridgeSmartGunSG153Heavyrubber
  components:
  - type: Tag
    tags:
    - MCCartridgeSmartGunSG153Heavyrubber
  - type: CartridgeAmmo
    proto: MCBulletSmartGunSG153Heavyrubber

- type: Tag
  id: MCCartridgeSmartGunSG153Heavyrubber

- type: entity
  parent: MCCartridgeSmartGunSG153
  id: MCCartridgeSmartGunSG153Plasmaloss
  components:
  - type: Tag
    tags:
    - MCCartridgeSmartGunSG153Plasmaloss
  - type: CartridgeAmmo
    proto: MCBulletSmartGunSG153Plasmaloss

- type: Tag
  id: MCCartridgeSmartGunSG153Plasmaloss

- type: entity
  parent: MCCartridgeSmartGunSG153
  id: MCCartridgeSmartGunSG153Tungsten
  components:
  - type: Tag
    tags:
    - MCCartridgeSmartGunSG153Tungsten
  - type: CartridgeAmmo
    proto: MCBulletSmartGunSG153Tungsten

- type: Tag
  id: MCCartridgeSmartGunSG153Tungsten

- type: entity
  parent: MCCartridgeSmartGunSG153
  id: MCCartridgeSmartGunSG153Incendiary
  components:
  - type: Tag
    tags:
    - MCCartridgeSmartGunSG153Incendiary
  - type: CartridgeAmmo
    proto: MCBulletSmartGunSG153Incendiary

- type: Tag
  id: MCCartridgeSmartGunSG153Incendiary

- type: entity
  parent: MCCartridgeSmartGunSG153
  id: MCCartridgeSmartGunSG153Flak
  components:
  - type: Tag
    tags:
    - MCCartridgeSmartGunSG153Flak
  - type: CartridgeAmmo
    proto: MCBulletSmartGunSG153Flak

- type: Tag
  id: MCCartridgeSmartGunSG153Flak

# Bullets SG-62
- type: entity
  parent: RMCBaseBullet
  id: MCBulletSmartGunSG62
  name: smart marksman bullet
  categories: [ HideSpawnMenu ]
  components:
  # accurate_range = 25
  # accurate_range_min = 3
  # Red bullets to indicate friendly fire restriction
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Projectiles/bullet.rsi
    layers:
    - state: red
      shader: unshaded
  - type: Projectile
    damage:
      groups:
        Brute: 40
  - type: CMArmorPiercing
    amount: 30
  - type: MCXenoSunderDamageOnHit
    amount: 5
  - type: RMCProjectileDamageFalloff
    thresholds:
    - range: 1
      falloff: 0.5
    - range: 40
      falloff: 9999
      ignoreModifiers: true
  - type: RMCProjectileAccuracy
    minAccuracy: 100

# Bullets SG-153
- type: entity
  parent: RMCBaseBullet
  id: MCBulletSmartGunSG153
  name: smart marksman bullet
  categories: [ HideSpawnMenu ]
  components:
  # Red bullets to indicate friendly fire restriction
  - type: Sprite
    sprite: _MC/Objects/Weapons/Guns/Ammunition/Projectiles/bullet.rsi
    layers:
    - state: red
      shader: unshaded
  - type: Projectile
    damage:
      groups:
        Brute: 50
  - type: CMArmorPiercing
    amount: 25
  - type: MCXenoSunderDamageOnHit
    amount: 5
  - type: RMCProjectileDamageFalloff
    thresholds:
    - range: 40
      falloff: 9999
      ignoreModifiers: true
  - type: RMCProjectileAccuracy
    minAccuracy: 100

- type: entity
  parent: MCBulletSmartGunSG153
  id: MCBulletSmartGunSG153Highimpact
  components:
  - type: Projectile
    damage:
      groups:
        Brute: 10
  - type: MCXenoSunderDamageOnHit
    amount: 0.5
  - type: MCStunOnHit
    staggerTime: 1
    slowdownTime: 1
    maxDistance: 12

- type: entity
  parent: MCBulletSmartGunSG153
  id: MCBulletSmartGunSG153Heavyrubber
  components:
  - type: Projectile
    damage:
      groups:
        Brute: 10
  - type: MCXenoSunderDamageOnHit
    amount: 0.5
  - type: MCStunOnHit
    paralyzeTime: 1
    slowdownTime: 1
    maxDistance: 12

- type: entity
  parent: MCBulletSmartGunSG153
  id: MCBulletSmartGunSG153Plasmaloss
  components:
  - type: Projectile
    damage:
      groups:
        Brute: 10
  - type: MCXenoSunderDamageOnHit
    amount: 0.5
  - type: MCXenoPlasmaDamageOnHit
    amount: 20
    multiplier: 0.2

- type: entity
  parent: MCBulletSmartGunSG153
  id: MCBulletSmartGunSG153Tungsten
  components:
  - type: Projectile
    damage:
      groups:
        Brute: 10
  - type: MCXenoSunderDamageOnHit
    amount: 0.5
  - type: MCStunOnHit
    knockback: 3
    knockbackSpeed: 15
    maxDistance: 12

- type: entity
  parent: MCBulletSmartGunSG153
  id: MCBulletSmartGunSG153Incendiary
  components:
  - type: Projectile
    damage:
      groups:
        Brute: 10
  - type: MCXenoSunderDamageOnHit
    amount: 0.5
  - type: IgniteOnProjectileHit
    intensity: 10
    duration: 10

- type: entity
  parent: MCBulletSmartGunSG153
  id: MCBulletSmartGunSG153Flak
  components:
  - type: Projectile
    damage:
      groups:
        Brute: 60
  - type: MCXenoSunderDamageOnHit
    amount: 0.5
  - type: RMCAreaDamage
    # TODO: airburst_multiplier = 0.5
    damageArea: 1.5
    falloffDistance: 9999
